---
bases:
- ../config/environments.yaml
- ../config/{{ .Environment.Name }}/helmdefaults.yaml
- ../config/{{ .Environment.Name }}/repositories.yaml
---

releases:
- name: {{ .Values | getOrNil "metricsserver.name" | default "metricsserver" }}
  chart: {{ .Values | getOrNil "metricsserver.chart" | default "stable/metrics-server" }}
  namespace: kube-system
  version: {{ .Values.metricsserver.version }}
  wait: true
  condition: metricsserver.enabled
  installed: true
  labels:
    chart: {{ .Values | getOrNil "metricsserver.name" | default "metricsserver" }}
    component: {{ .Values | getOrNil "metricsserver.name" | default "metricsserver" }}
    namespace: kube-system
  values:
  - args:
    - '--kubelet-insecure-tls'
    - '--kubelet-preferred-address-types=InternalIP'
